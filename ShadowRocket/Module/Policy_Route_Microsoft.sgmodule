#!name = 【路由策略】Microsoft
#!desc = Microsoft公司的路由策略
#!openUrl =
#!author = 
#!homepage =
#!icon =
#!date = 20240220

[Rule]

####################################
# 拦截规则
####################################

# URL-REGEX, ^https:\/\/, REJECT


####################################
# 代理规则
####################################

# 🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆
# CDN

DOMAIN-SUFFIX, msedge.net, PROXY
DOMAIN-KEYWORD, -msedge.net, PROXY
DOMAIN-SUFFIX, azure.com, PROXY
DOMAIN-SUFFIX, msocdn.com, PROXY
DOMAIN-SUFFIX, akamaiedge.net, PROXY


# 🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆
# Github
DOMAIN-SUFFIX, github.com, PROXY
DOMAIN-SUFFIX, githubusercontent.com, PROXY


# 🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆
# VSCODE
DOMAIN-SUFFIX, visualstudio.com, PROXY
DOMAIN-SUFFIX, vscode.dev, PROXY
DOMAIN-SUFFIX, vscode-cdn.net, PROXY
DOMAIN-SUFFIX, vscode-unpkg.net, PROXY
DOMAIN-SUFFIX, msecnd.net, PROXY
DOMAIN-SUFFIX, exp-tas.com, PROXY
DOMAIN-SUFFIX, vsassets.io, PROXY
DOMAIN-SUFFIX, mobile.events.data.microsoft.com, PROXY


# 🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆
# OneDrive
DOMAIN-SUFFIX, onedrive.live.com, PROXY
DOMAIN-SUFFIX, onedrive.com, PROXY
DOMAIN-SUFFIX, svc.ms, PROXY
DOMAIN-SUFFIX, trafficmanager.net, PROXY
DOMAIN-SUFFIX, content.lifecycle.office.net, PROXY

DOMAIN-SUFFIX,1drv.com
DOMAIN-SUFFIX,livefilestore.com
DOMAIN-SUFFIX,oneclient.sfx.ms
DOMAIN-SUFFIX,onedrive.com
DOMAIN-SUFFIX,onedrive.live.com
DOMAIN-SUFFIX,photos.live.com
DOMAIN-SUFFIX,sharepoint.com
DOMAIN-SUFFIX,sharepointonline.com
DOMAIN-SUFFIX,skydrive.wns.windows.com
DOMAIN-SUFFIX,spoprod-a.akamaihd.net
DOMAIN-SUFFIX,storage.live.com
DOMAIN-SUFFIX,storage.msn.com
DOMAIN-KEYWORD,1drv
DOMAIN-KEYWORD,onedrive
DOMAIN-KEYWORD,skydrive
USER-AGENT,OneDrive*
USER-AGENT,OneDriveiOSApp*

####################################
# 直连规则
####################################

# DOMAIN-SUFFIX, microsoftonline.com, DIRECT
# DOMAIN-SUFFIX, microsoft.com, DIRECT

# DOMAIN-SUFFIX, appcenter.ms, DIRECT


# ♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️
# 以下的域名涉及到的服务可以在中国境内直连

DOMAIN-SUFFIX, dl.delivery.mp.microsoft.com, DIRECT
DOMAIN-SUFFIX, download.windowsupdate.com, DIRECT
DOMAIN-SUFFIX, res.cdn.office.net, DIRECT
DOMAIN-SUFFIX, bg.v4.a.dl.ws.microsoft.com, DIRECT
DOMAIN-SUFFIX, bg4.v4.a.dl.ws.microsoft.com, DIRECT
DOMAIN-SUFFIX, build.microsoft.com, DIRECT
DOMAIN-SUFFIX, cdn.marketplaceimages.windowsphone.com, DIRECT
DOMAIN-SUFFIX, cn.windowssearch.com, DIRECT
DOMAIN-SUFFIX, ctldl.windowsupdate.com, DIRECT
DOMAIN-SUFFIX, devblogs.microsoft.com, DIRECT
DOMAIN-SUFFIX, developer.microsoft.com, DIRECT
DOMAIN-SUFFIX, docs.microsoft.com, DIRECT
DOMAIN-SUFFIX, download.microsoft.com, DIRECT
DOMAIN-SUFFIX, download.visualstudio.microsoft.com, DIRECT
DOMAIN-SUFFIX, fs.microsoft.com, DIRECT
DOMAIN-SUFFIX, learn.microsoft.com, DIRECT
DOMAIN-SUFFIX, msgr.dlservice.microsoft.com, DIRECT
DOMAIN-SUFFIX, msgruser.dlservice.microsoft.com, DIRECT
DOMAIN-SUFFIX, myvs.download.prss.microsoft.com, DIRECT
DOMAIN-SUFFIX, oemsoc.download.prss.microsoft.com, DIRECT
DOMAIN-SUFFIX, officecdn.microsoft.com, DIRECT
DOMAIN-SUFFIX, qh.dlservice.microsoft.com, DIRECT
DOMAIN-SUFFIX, sdx.microsoft.com, DIRECT
DOMAIN-SUFFIX, silverlight.dlservice.microsoft.com, DIRECT
DOMAIN-SUFFIX, slupdate.dlservice.microsoft.com, DIRECT
DOMAIN-SUFFIX, software.download.prss.microsoft.com, DIRECT
DOMAIN-SUFFIX, storeedgefd.dsx.mp.microsoft.com, DIRECT
DOMAIN-SUFFIX, surface.downloads.prss.microsoft.com, DIRECT
DOMAIN-SUFFIX, vscode.download.prss.microsoft.com, DIRECT
DOMAIN-SUFFIX, vz.download.prss.microsoft.com, DIRECT
DOMAIN-SUFFIX, wl.dlservice.microsoft.com, DIRECT
DOMAIN-SUFFIX, wscont1.apps.microsoft.com, DIRECT
DOMAIN-SUFFIX, wscont2.apps.microsoft.com, DIRECT
DOMAIN-SUFFIX, xb.dlservice.microsoft.com


[MITM]
# hostname = %APPEND% 
