#!name = 【路由策略】Microsoft
#!desc = Microsoft公司的路由策略
#!openUrl =
#!author = 
#!homepage =
#!icon =
#!date = 20240220

[Rule]

####################################
# 拦截规则
####################################

# URL-REGEX, ^https:\/\/, REJECT


####################################
# 代理规则
####################################

# 🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆
# CDN

DOMAIN-SUFFIX, msocdn.com, PROXY
DOMAIN-SUFFIX, akamaiedge.net, PROXY
DOMAIN-SUFFIX, msedge.net, PROXY
DOMAIN-SUFFIX, a-msedge.net, PROXY
DOMAIN-SUFFIX, b-msedge.net, PROXY
DOMAIN-SUFFIX, c-msedge.net, PROXY
DOMAIN-SUFFIX, d-msedge.net, PROXY
DOMAIN-SUFFIX, e-msedge.net, PROXY
DOMAIN-SUFFIX, f-msedge.net, PROXY
DOMAIN-SUFFIX, g-msedge.net, PROXY
DOMAIN-SUFFIX, h-msedge.net, PROXY
DOMAIN-SUFFIX, i-msedge.net, PROXY
DOMAIN-SUFFIX, j-msedge.net, PROXY
DOMAIN-SUFFIX, k-msedge.net, PROXY
DOMAIN-SUFFIX, l-msedge.net, PROXY
DOMAIN-SUFFIX, m-msedge.net, PROXY
DOMAIN-SUFFIX, n-msedge.net, PROXY
DOMAIN-SUFFIX, o-msedge.net, PROXY
DOMAIN-SUFFIX, p-msedge.net, PROXY
DOMAIN-SUFFIX, q-msedge.net, PROXY
DOMAIN-SUFFIX, r-msedge.net, PROXY
DOMAIN-SUFFIX, s-msedge.net, PROXY
DOMAIN-SUFFIX, t-msedge.net, PROXY
DOMAIN-SUFFIX, u-msedge.net, PROXY
DOMAIN-SUFFIX, v-msedge.net, PROXY
DOMAIN-SUFFIX, w-msedge.net, PROXY
DOMAIN-SUFFIX, x-msedge.net, PROXY
DOMAIN-SUFFIX, y-msedge.net, PROXY
DOMAIN-SUFFIX, z-msedge.net, PROXY



# 🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆
# Azure

DOMAIN-SUFFIX, azure.com, PROXY
DOMAIN-SUFFIX, azure-dns.com, PROXY
DOMAIN-SUFFIX, azure-dns.info, PROXY
DOMAIN-SUFFIX, azure-dns.net, PROXY
DOMAIN-SUFFIX, azure-dns.org, PROXY


# 🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆
# Github

DOMAIN-SUFFIX, github.com, PROXY
DOMAIN-SUFFIX, githubusercontent.com, PROXY


# 🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆
# VSCODE

DOMAIN-SUFFIX, visualstudio.com, PROXY
DOMAIN-SUFFIX, vscode.dev, PROXY
DOMAIN-SUFFIX, vscode-cdn.net, PROXY
DOMAIN-SUFFIX, vscode-unpkg.net, PROXY
DOMAIN-SUFFIX, msecnd.net, PROXY
DOMAIN-SUFFIX, exp-tas.com, PROXY
DOMAIN-SUFFIX, vsassets.io, PROXY
DOMAIN-SUFFIX, mobile.events.data.microsoft.com, PROXY


# 🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆
# OneDrive

DOMAIN-SUFFIX, svc.ms, PROXY
DOMAIN-SUFFIX, trafficmanager.net, PROXY
DOMAIN-SUFFIX, content.lifecycle.office.net, PROXY

DOMAIN-SUFFIX, 1drv.com, PROXY
DOMAIN-SUFFIX, livefilestore.com, PROXY
DOMAIN-SUFFIX, onedrive.com, PROXY
DOMAIN-SUFFIX, onedrive.live.com, PROXY
DOMAIN-SUFFIX, oneclient.sfx.ms, PROXY
DOMAIN-SUFFIX, photos.live.com, PROXY
DOMAIN-SUFFIX, sharepoint.com, PROXY
DOMAIN-SUFFIX, sharepointonline.com, PROXY
DOMAIN-SUFFIX, skydrive.wns.windows.com, PROXY
DOMAIN-SUFFIX, spoprod-a.akamaihd.net, PROXY
DOMAIN-SUFFIX, storage.live.com, PROXY
DOMAIN-SUFFIX, storage.msn.com, PROXY
DOMAIN-KEYWORD, 1drv, PROXY
DOMAIN-KEYWORD, onedrive, PROXY
DOMAIN-KEYWORD, skydrive, PROXY
USER-AGENT, OneDrive*, PROXY
USER-AGENT, OneDriveiOSApp*, PROXY


# 🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆🔆
# Windows

DOMAIN-SUFFIX, microsoft.az, PROXY
DOMAIN-SUFFIX, microsoft.be, PROXY
DOMAIN-SUFFIX, microsoft.by, PROXY
DOMAIN-SUFFIX, microsoft.ca, PROXY
DOMAIN-SUFFIX, microsoft.cat, PROXY
DOMAIN-SUFFIX, microsoft.ch, PROXY
DOMAIN-SUFFIX, microsoft.cl, PROXY
DOMAIN-SUFFIX, microsoft.com, PROXY
DOMAIN-SUFFIX, microsoft.cz, PROXY
DOMAIN-SUFFIX, microsoft.de, PROXY
DOMAIN-SUFFIX, microsoft.dk, PROXY
DOMAIN-SUFFIX, microsoft.ee, PROXY
DOMAIN-SUFFIX, microsoft.es, PROXY
DOMAIN-SUFFIX, microsoft.eu, PROXY
DOMAIN-SUFFIX, microsoft.fi, PROXY
DOMAIN-SUFFIX, microsoft.ge, PROXY
DOMAIN-SUFFIX, microsoft.hu, PROXY
DOMAIN-SUFFIX, microsoft.io, PROXY
DOMAIN-SUFFIX, microsoft.is, PROXY
DOMAIN-SUFFIX, microsoft.it, PROXY
DOMAIN-SUFFIX, microsoft.jp, PROXY
DOMAIN-SUFFIX, microsoft.lt, PROXY
DOMAIN-SUFFIX, microsoft.lu, PROXY
DOMAIN-SUFFIX, microsoft.lv, PROXY
DOMAIN-SUFFIX, microsoft.md, PROXY
DOMAIN-SUFFIX, microsoft.net, PROXY
DOMAIN-SUFFIX, microsoft.pl, PROXY
DOMAIN-SUFFIX, microsoft.pt, PROXY
DOMAIN-SUFFIX, microsoft.red, PROXY
DOMAIN-SUFFIX, microsoft.ro, PROXY
DOMAIN-SUFFIX, microsoft.rs, PROXY
DOMAIN-SUFFIX, microsoft.ru, PROXY
DOMAIN-SUFFIX, microsoft.se, PROXY
DOMAIN-SUFFIX, microsoft.si, PROXY
DOMAIN-SUFFIX, microsoft.tv, PROXY
DOMAIN-SUFFIX, microsoft.ua, PROXY
DOMAIN-SUFFIX, microsoft.uz, PROXY
DOMAIN-SUFFIX, microsoft.vn, PROXY




####################################
# 直连规则
####################################

# DOMAIN-SUFFIX, microsoftonline.com, DIRECT
# DOMAIN-SUFFIX, microsoft.com, DIRECT

# DOMAIN-SUFFIX, appcenter.ms, DIRECT

# ♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️
# Azure

DOMAIN-SUFFIX, azure-dns.cn, DIRECT


# ♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️♻️
# 以下的域名涉及到的服务可以在中国境内直连

DOMAIN-SUFFIX, dl.delivery.mp.microsoft.com, DIRECT
DOMAIN-SUFFIX, download.windowsupdate.com, DIRECT
DOMAIN-SUFFIX, res.cdn.office.net, DIRECT
DOMAIN-SUFFIX, bg.v4.a.dl.ws.microsoft.com, DIRECT
DOMAIN-SUFFIX, bg4.v4.a.dl.ws.microsoft.com, DIRECT
DOMAIN-SUFFIX, build.microsoft.com, DIRECT
DOMAIN-SUFFIX, cdn.marketplaceimages.windowsphone.com, DIRECT
DOMAIN-SUFFIX, cn.windowssearch.com, DIRECT
DOMAIN-SUFFIX, ctldl.windowsupdate.com, DIRECT
DOMAIN-SUFFIX, devblogs.microsoft.com, DIRECT
DOMAIN-SUFFIX, developer.microsoft.com, DIRECT
DOMAIN-SUFFIX, docs.microsoft.com, DIRECT
DOMAIN-SUFFIX, download.microsoft.com, DIRECT
DOMAIN-SUFFIX, download.visualstudio.microsoft.com, DIRECT
DOMAIN-SUFFIX, fs.microsoft.com, DIRECT
DOMAIN-SUFFIX, learn.microsoft.com, DIRECT
DOMAIN-SUFFIX, msgr.dlservice.microsoft.com, DIRECT
DOMAIN-SUFFIX, msgruser.dlservice.microsoft.com, DIRECT
DOMAIN-SUFFIX, myvs.download.prss.microsoft.com, DIRECT
DOMAIN-SUFFIX, oemsoc.download.prss.microsoft.com, DIRECT
DOMAIN-SUFFIX, officecdn.microsoft.com, DIRECT
DOMAIN-SUFFIX, qh.dlservice.microsoft.com, DIRECT
DOMAIN-SUFFIX, sdx.microsoft.com, DIRECT
DOMAIN-SUFFIX, silverlight.dlservice.microsoft.com, DIRECT
DOMAIN-SUFFIX, slupdate.dlservice.microsoft.com, DIRECT
DOMAIN-SUFFIX, software.download.prss.microsoft.com, DIRECT
DOMAIN-SUFFIX, storeedgefd.dsx.mp.microsoft.com, DIRECT
DOMAIN-SUFFIX, surface.downloads.prss.microsoft.com, DIRECT
DOMAIN-SUFFIX, vscode.download.prss.microsoft.com, DIRECT
DOMAIN-SUFFIX, vz.download.prss.microsoft.com, DIRECT
DOMAIN-SUFFIX, wl.dlservice.microsoft.com, DIRECT
DOMAIN-SUFFIX, wscont1.apps.microsoft.com, DIRECT
DOMAIN-SUFFIX, wscont2.apps.microsoft.com, DIRECT
DOMAIN-SUFFIX, xb.dlservice.microsoft.com


[MITM]
# hostname = %APPEND% 
